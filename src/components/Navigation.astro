---
import { createNavigation } from "./Navigation";
import { createLocale } from "@lib/i18n";
import Languages from "~icons/heroicons/language-16-solid";
import { getUrlWithoutLocale } from "astro-i18n-aut";

interface Props {
    class?: string;
    back?: string;
}
const { class: className, back = "/" } = Astro.props;

const { getLocaleUrl, str, normalizedUrl, locale } = createLocale(Astro.url);

const localizedBack = getLocaleUrl(back);

const pathname = new URL(normalizedUrl, Astro.url).pathname;
const c = (path: string, className: string) => (pathname === path ? className : "");


const navigation = createNavigation(
    [
        {
            label: "Home",
            path: getLocaleUrl("/"),
        },
        {
            label: "Blog",
            path: getLocaleUrl("/blog"),
        },
    ],
    Astro.url
);

const active = (path: string) => pathname === getUrlWithoutLocale(path);
---
<nav class={`${className}`}>
    <div class="flex justify-between gap-10 text-brand-border items-center">
        <div>
            <a
                href={localizedBack}
                class:list={[
                    "flex items-center gap-2 md:border-b border-brand-border",
                    [c(back, "invisible")],
                ]}
                aria-hidden={pathname === back}
                aria-label={str("back", "terug")}>
                ‚Üê <span class="hidden md:inline">{str("back", "terug")}</span>
            </a>
        </div>
        <ul class="flex gap-10">
            {
                navigation.map(({ label, path }) => (
                    <li>
                        <a
                            href={path}
                            class:list={["flex items-center gap-2", active(path) && "text-brand-muted"]}>
                            {label}
                        </a>
                    </li>
                ))
            }
            <li class="flex items-center gap-2 text-sm">
                <Languages class="h-4 w-4" />
                <a href={getLocaleUrl(Astro.url, locale === "en" ? "nl" : "en")} class="flex items-center gap-1">
                    <span class:list={[locale === "en" && "text-brand-muted"]}>en</span>
                    <span class="text-brand-border/50">/</span>
                    <span class:list={[locale === "nl" && "text-brand-muted"]}>nl</span>
                </a>
            </li>
        </ul>
    </div>
</nav>